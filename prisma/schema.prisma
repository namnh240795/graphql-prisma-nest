// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model client {
  id             Int              @id @default(autoincrement())
  email          String?          @unique
  phone          String           @unique
  password       String
  date_created   DateTime         @default(now())
  date_modified  DateTime         @default(now()) @updatedAt
  client_api_key client_api_key[]
}

model client_api_key {
  id            String   @id @default(uuid())
  date_created  DateTime @default(now())
  date_modified DateTime @default(now()) @updatedAt
  public_key    String
  private_key   String
  api_hash      String
  client        client   @relation(fields: [client_id], references: [id])
  client_id     Int
}

model role {
  id              Int               @id @default(autoincrement())
  name            String            @unique
  role_permission role_permission[]
  date_created    DateTime          @default(now())
  date_modified   DateTime          @default(now()) @updatedAt
}

model role_permission {
  id            Int        @id @default(autoincrement())
  role          role       @relation(fields: [role_id], references: [id])
  role_id       Int
  permission    permission @relation(fields: [permission_id], references: [id])
  permission_id Int
  date_created  DateTime   @default(now())
  date_modified DateTime   @default(now()) @updatedAt
}

model permission {
  id              Int               @id @default(autoincrement())
  name            String            @unique
  permission_api  permission_api[]
  role_permission role_permission[]
  date_created    DateTime          @default(now())
  date_modified   DateTime          @default(now()) @updatedAt
}

model api {
  id             Int              @id @default(autoincrement())
  path           String           @unique
  permission_api permission_api[]
  date_created   DateTime         @default(now())
  date_modified  DateTime         @default(now()) @updatedAt
}

model permission_api {
  id            Int        @id @default(autoincrement())
  permission    permission @relation(fields: [permission_id], references: [id])
  permission_id Int
  api           api        @relation(fields: [api_id], references: [id])
  api_id        Int
  date_created  DateTime   @default(now())
  date_modified DateTime   @default(now()) @updatedAt
}

model account {
  id            Int      @id @default(autoincrement())
  email         String?  @unique
  phone         String   @unique
  password      String
  date_created  DateTime @default(now())
  date_modified DateTime @default(now()) @updatedAt
}
